---
title: "Chapter 9 - functionals"
author: "Ian"
date: "2023-01-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library("purrr")
```


# 9.2.6 Exercises

## #1 Use as_mapper() to explore how purrr generates anonymous functions for the integer, character, and list helpers. What helper allows you to extract attributes? Read the documentation to find out. 

```{r}
as_mapper(c("lorem", "ipsome", "dolor"))
```
```{r}
as_mapper(c(1,2,3))
```
```{r}
as_mapper(c("lorem", 2, "dolor"))
```
`as_mapper()` uses `pluck_raw()` to assist it in extracting values.The `pluck()` function is a part of the `purrr` package in R. It is used to extract a value from a nested list or data frame by providing the key(s) or index(es) for the value you want to extract. 

## #2  map(1:3, ~ runif(2)) is a useful pattern for generating random numbers, but map(1:3, runif(2)) is not. Why not? Can you explain why it returns the result that it does?

When using the '~' operator the `runif()` function is called as an anonymous function, meaning it is called within `map()` without it, the `runif()` function is called before `map()` meaning each instance of `map()` being called will return the same list of 2 random numbers.

## #3 Use the appropriate map() function to:
#### Compute the standard deviation of every column in a numeric data frame.
```{r}
random_df <- data.frame(x = rnorm(10), y = rnorm(10), z = rnorm(10))
stddev <- map_dbl(random_df, sd)
print(stddev)
```
#### Compute the standard deviation of every numeric column in a mixed data frame. (Hint: youâ€™ll need to do it in two steps.)
```{r}
random_df <- data.frame(x = rnorm(10), y = rnorm(10), z = rnorm(10),label = letters[1:10])
numeric_df <- select_if(random_df, is.numeric)
stddev <- map_dbl(numeric_df, sd)
print(stddev)
```
#### Compute the number of levels for every factor in a data frame.
```{r}
new_df <- data.frame(x = factor(letters[1:10]), y = factor(letters[11:20]))

# compute number of levels for each factor column
factored <- map_int(new_df, nlevels)
print(factored)
```
### #4 The following code simulates the performance of a t-test for non-normal data. Extract the p-value from each test, then visualise.
```{r}
trials <- map(1:100, ~ t.test(rpois(10, 10), rpois(7, 10)))
p_values <- map_dbl(trials, "p.value")
print(p_values)
hist(p_values)
```